var E=Object.defineProperty,I=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var S=(a,r,s)=>r in a?E(a,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[r]=s,x=(a,r)=>{for(var s in r||(r={}))P.call(r,s)&&S(a,s,r[s]);if(w)for(var s of w(r))A.call(r,s)&&S(a,s,r[s]);return a},f=(a,r)=>I(a,O(r));import{j as e}from"./index-01a43d90.js";import{r as o}from"./vendor-9fe24c3f.js";import{Q as p}from"./ui-9e04399f.js";import{u as B}from"./router-4197aa40.js";import"./supabase-f3f4aacd.js";const T="product_reviews",Y=({products:a=[]})=>{var b;const[r,s]=o.useState(String(((b=a[0])==null?void 0:b.id)||"")),[c,h]=o.useState(""),[v,y]=o.useState(5),[d,u]=o.useState(""),[m,g]=o.useState({}),j=B();o.useEffect(()=>{try{const t=localStorage.getItem(T);g(t?JSON.parse(t):{})}catch(t){console.error("Failed to read reviews",t),g({})}},[]);const N=t=>{try{localStorage.setItem(T,JSON.stringify(t)),g(t)}catch(i){console.error("Failed to save reviews",i)}};o.useEffect(()=>{!r&&a[0]&&s(String(a[0].id))},[r,a]);const R=t=>{if(t.preventDefault(),!c.trim()||!d.trim())return p.error("Please provide name and review");try{const i=x({},m),l=String(r),k=[...Array.isArray(i[l])?i[l]:[],{id:Date.now(),name:c.trim(),rating:v,text:d.trim(),date:new Date().toISOString()}],C=f(x({},i),{[l]:k});N(C),h(""),u(""),y(5),p.success("Thank you — your review has been saved.")}catch(i){console.error(i),p.error("Failed to save review")}};return e.jsx("div",{className:"section",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[e.jsx("h2",{className:"section-title",children:"Write a Review"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>j("/"),children:"Back Home"})]}),e.jsxs("form",{onSubmit:R,style:{maxWidth:720,marginTop:"1rem"},children:[e.jsxs("label",{children:["Product",e.jsx("select",{value:r,onChange:t=>s(String(t.target.value)),style:{width:"100%",padding:"8px",marginTop:"0.5rem"},children:a.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsxs("label",{style:{marginTop:"0.75rem",display:"block"},children:["Your Name",e.jsx("input",{value:c,onChange:t=>h(t.target.value),style:{width:"100%",padding:"8px",marginTop:"0.5rem"}})]}),e.jsxs("label",{style:{marginTop:"0.75rem",display:"block"},children:["Rating",e.jsx("select",{value:v,onChange:t=>y(Number(t.target.value)),style:{width:"100%",padding:"8px",marginTop:"0.5rem"},children:[5,4,3,2,1].map(t=>e.jsxs("option",{value:t,children:[t," Star",t>1?"s":""]},t))})]}),e.jsxs("label",{style:{marginTop:"0.75rem",display:"block"},children:["Review",e.jsx("textarea",{value:d,onChange:t=>u(t.target.value),style:{width:"100%",padding:"8px",marginTop:"0.5rem",minHeight:120}})]}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn",type:"submit",children:"Submit Review"}),e.jsx("button",{type:"button",className:"btn outline",onClick:()=>j(-1),children:"Cancel"})]})]}),e.jsxs("div",{style:{marginTop:"2rem"},children:[e.jsx("h3",{children:"Submitted Reviews"}),Object.keys(m).length===0&&e.jsx("p",{style:{color:"var(--text-gray)"},children:"No reviews yet — be the first to share your experience."}),Object.entries(m).map(([t,i])=>{var l;return e.jsxs("div",{style:{marginTop:"1rem"},children:[e.jsx("h4",{style:{marginBottom:"0.5rem"},children:((l=a.find(n=>String(n.id)===String(t)))==null?void 0:l.name)||"Product"}),i.map(n=>e.jsxs("div",{className:"review-card",style:{marginBottom:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("strong",{children:n.name}),e.jsx("span",{style:{color:"var(--text-gray)"},children:new Date(n.date).toLocaleString()})]}),e.jsxs("div",{style:{color:"var(--gold)"},children:["★".repeat(n.rating),"☆".repeat(5-n.rating)]}),e.jsx("p",{style:{color:"var(--text-gray)",marginTop:"0.5rem"},children:n.text})]},n.id))]},t)})]})]})})};export{Y as default};
