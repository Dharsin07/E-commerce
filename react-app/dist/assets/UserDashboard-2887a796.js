var b=(r,o,c)=>new Promise((p,i)=>{var u=a=>{try{x(c.next(a))}catch(j){i(j)}},m=a=>{try{x(c.throw(a))}catch(j){i(j)}},x=a=>a.done?p(a.value):Promise.resolve(a.value).then(u,m);x((c=c.apply(r,o)).next())});import{o as f,c as C,w as $,j as s}from"./index-02495058.js";import{r as l}from"./vendor-9fe24c3f.js";import{L as d}from"./router-4197aa40.js";import"./ui-9e04399f.js";import"./supabase-f3f4aacd.js";const q=()=>{const[r,o]=l.useState("orders"),[c,p]=l.useState([]),[i,u]=l.useState([]),[m,x]=l.useState([]),[a,j]=l.useState([]),[v,N]=l.useState(!0);l.useEffect(()=>{g()},[]);const g=()=>b(void 0,null,function*(){try{N(!0);const[e,t,h]=yield Promise.all([f.getOrders(),C.getCartItems(),$.getWishlistItems()]);p((e==null?void 0:e.data)||[]),u((t==null?void 0:t.data)||[]),x((h==null?void 0:h.data)||[]);const n=JSON.parse(localStorage.getItem("recentViews")||"[]");j(n)}catch(e){console.error("Failed to fetch user data:",e)}finally{N(!1)}}),y=e=>({pending:"#f39c12",confirmed:"#3498db",shipped:"#9b59b6",delivered:"#27ae60",cancelled:"#e74c3c"})[e]||"#95a5a6",w=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return v?s.jsxs("div",{className:"dashboard-loading",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:"Loading your dashboard..."})]}):s.jsxs("div",{className:"user-dashboard",children:[s.jsxs("div",{className:"dashboard-header",children:[s.jsx("h1",{children:"My Dashboard"}),s.jsx("p",{children:"Manage your orders, cart, wishlist and more"})]}),s.jsxs("div",{className:"dashboard-tabs",children:[s.jsxs("button",{className:`tab-btn ${r==="orders"?"active":""}`,onClick:()=>o("orders"),children:["Orders (",c.length,")"]}),s.jsxs("button",{className:`tab-btn ${r==="cart"?"active":""}`,onClick:()=>o("cart"),children:["Cart (",i.length,")"]}),s.jsxs("button",{className:`tab-btn ${r==="wishlist"?"active":""}`,onClick:()=>o("wishlist"),children:["Wishlist (",m.length,")"]}),s.jsxs("button",{className:`tab-btn ${r==="recent"?"active":""}`,onClick:()=>o("recent"),children:["Recent Views (",a.length,")"]})]}),s.jsxs("div",{className:"dashboard-content",children:[r==="orders"&&s.jsxs("div",{className:"orders-section",children:[s.jsx("h2",{children:"My Orders"}),c.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("p",{children:"You haven't placed any orders yet."}),s.jsx(d,{to:"/products",className:"btn btn-primary",children:"Start Shopping"})]}):s.jsx("div",{className:"orders-grid",children:c.map(e=>{var t,h;return s.jsxs("div",{className:"order-card",children:[s.jsxs("div",{className:"order-header",children:[s.jsxs("div",{children:[s.jsxs("h3",{children:["Order #",e.id]}),s.jsx("p",{className:"order-date",children:w(e.created_at)})]}),s.jsx("span",{className:"order-status",style:{backgroundColor:y(e.status)},children:e.status})]}),s.jsxs("div",{className:"order-items",children:[(t=e.items)==null?void 0:t.slice(0,3).map((n,S)=>s.jsxs("div",{className:"order-item",children:[s.jsx("img",{src:n.image,alt:n.name}),s.jsxs("div",{children:[s.jsx("p",{children:n.name}),s.jsxs("p",{children:["Qty: ",n.quantity]})]}),s.jsxs("p",{className:"item-price",children:["$",n.price]})]},S)),((h=e.items)==null?void 0:h.length)>3&&s.jsxs("p",{className:"more-items",children:["+",e.items.length-3," more items"]})]}),s.jsxs("div",{className:"order-footer",children:[s.jsxs("p",{className:"order-total",children:["Total: $",e.total_amount]}),s.jsx(d,{to:`/orders/${e.id}`,className:"btn btn-outline",children:"View Details"})]})]},e.id)})})]}),r==="cart"&&s.jsxs("div",{className:"cart-section",children:[s.jsx("h2",{children:"Shopping Cart"}),i.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("p",{children:"Your cart is empty."}),s.jsx(d,{to:"/products",className:"btn btn-primary",children:"Continue Shopping"})]}):s.jsxs("div",{className:"cart-items",children:[i.map(e=>s.jsxs("div",{className:"cart-item",children:[s.jsx("img",{src:e.image,alt:e.name}),s.jsxs("div",{className:"item-details",children:[s.jsx("h3",{children:e.name}),s.jsxs("p",{children:["Price: $",e.price]}),s.jsxs("div",{className:"quantity-controls",children:[s.jsx("button",{children:"-"}),s.jsx("span",{children:e.quantity}),s.jsx("button",{children:"+"})]})]}),s.jsxs("div",{className:"item-actions",children:[s.jsxs("p",{className:"item-total",children:["$",e.price*e.quantity]}),s.jsx("button",{className:"btn-remove",children:"Remove"})]})]},e.id)),s.jsxs("div",{className:"cart-summary",children:[s.jsx("h3",{children:"Cart Summary"}),s.jsxs("p",{children:["Subtotal: $",i.reduce((e,t)=>e+t.price*t.quantity,0)]}),s.jsx(d,{to:"/checkout",className:"btn btn-primary",children:"Proceed to Checkout"})]})]})]}),r==="wishlist"&&s.jsxs("div",{className:"wishlist-section",children:[s.jsx("h2",{children:"My Wishlist"}),m.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("p",{children:"Your wishlist is empty."}),s.jsx(d,{to:"/products",className:"btn btn-primary",children:"Browse Products"})]}):s.jsx("div",{className:"wishlist-grid",children:m.map(e=>s.jsxs("div",{className:"wishlist-item",children:[s.jsx("img",{src:e.image,alt:e.name}),s.jsxs("div",{className:"wishlist-content",children:[s.jsx("h3",{children:e.name}),s.jsxs("p",{className:"price",children:["$",e.price]}),s.jsxs("div",{className:"wishlist-actions",children:[s.jsx("button",{className:"btn btn-primary",children:"Add to Cart"}),s.jsx("button",{className:"btn btn-outline",children:"Remove"})]})]})]},e.id))})]}),r==="recent"&&s.jsxs("div",{className:"recent-section",children:[s.jsx("h2",{children:"Recently Viewed"}),a.length===0?s.jsxs("div",{className:"empty-state",children:[s.jsx("p",{children:"You haven't viewed any products yet."}),s.jsx(d,{to:"/products",className:"btn btn-primary",children:"Explore Products"})]}):s.jsx("div",{className:"recent-grid",children:a.map((e,t)=>s.jsxs("div",{className:"recent-item",children:[s.jsx("img",{src:e.image,alt:e.name}),s.jsxs("div",{className:"recent-content",children:[s.jsx("h3",{children:e.name}),s.jsxs("p",{className:"price",children:["$",e.price]}),s.jsx(d,{to:`/products/${e.id}`,className:"btn btn-outline",children:"View Product"})]})]},t))})]})]})]})};export{q as default};
