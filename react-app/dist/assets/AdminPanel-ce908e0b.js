var M=Object.defineProperty,V=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var I=(m,o,n)=>o in m?M(m,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[o]=n,a=(m,o)=>{for(var n in o||(o={}))X.call(o,n)&&I(m,n,o[n]);if(R)for(var n of R(o))Y.call(o,n)&&I(m,n,o[n]);return m},i=(m,o)=>V(m,W(o));var P=(m,o,n)=>new Promise((k,U)=>{var E=c=>{try{t(n.next(c))}catch(r){U(r)}},D=c=>{try{t(n.throw(c))}catch(r){U(r)}},t=c=>c.done?k(c.value):Promise.resolve(c.value).then(E,D);t((n=n.apply(m,o)).next())});import{b as Z,j as e,f as T,d as ee,e as se,h as ae}from"./index-02495058.js";import{r as j}from"./vendor-9fe24c3f.js";import{Q as x}from"./ui-9e04399f.js";import"./router-4197aa40.js";import"./supabase-f3f4aacd.js";const ce=({isOpen:m,onClose:o,products:n,orders:k,onAddProduct:U,onUpdateProduct:E,onDeleteProduct:D})=>{const[t,c]=j.useState("products"),[r,v]=j.useState({name:"",category:"living-room",price:"",description:"",images:[""],inStock:!0}),[q,A]=j.useState(null),[l,g]=j.useState({name:"",category:"living-room",price:"",description:"",images:[""],inStock:!0}),[h,C]=j.useState({name:"",email:"",password:"",role:"user"}),[w,L]=j.useState(null),[u,b]=j.useState({name:"",email:"",password:"",role:"user"}),[N,S]=j.useState([]),[$,F]=j.useState(!1);j.useEffect(()=>{(t==="users"||t==="addUser"||t==="editUser")&&(F(!0),Z().then(S).catch(s=>{console.error("Failed to load users:",s),x.error("Failed to load users")}).finally(()=>F(!1)))},[t]);const O=s=>{s.preventDefault();const p=(r.images||[]).map(y=>String(y||"").trim()).filter(Boolean),d=parseFloat(r.price);if(Number.isNaN(d)){x.error("Please enter a valid price");return}const f=i(a({},r),{category_id:r.category==="living-room"?1:r.category==="bedroom"?2:r.category==="dining"?3:r.category==="office"?4:1,images:p,price:d,featured:!1});U(f),v({name:"",category:"living-room",price:"",description:"",images:[""],inStock:!0})},B=s=>{A(s),g({name:s.name,category:s.category,price:s.price.toString(),description:s.description||"",images:Array.isArray(s.images)&&s.images.length>0?s.images:[""],inStock:s.inStock}),c("edit")},_=s=>{s.preventDefault();const p=(l.images||[]).map(y=>String(y||"").trim()).filter(Boolean),d=parseFloat(l.price);if(Number.isNaN(d)){x.error("Please enter a valid price");return}const f={name:l.name,category_id:l.category==="living-room"?1:l.category==="bedroom"?2:l.category==="dining"?3:l.category==="office"?4:1,price:d,description:l.description,images:p,inStock:l.inStock};E(q.id,f),A(null),g({name:"",category:"living-room",price:"",description:"",images:[""],inStock:!0}),c("products")},Q=()=>{A(null),g({name:"",category:"living-room",price:"",description:"",images:[""],inStock:!0}),c("products")},z=s=>P(void 0,null,function*(){if(s.preventDefault(),N.find(d=>d.email===h.email)){x.error("User with this email already exists");return}try{yield ee(h.email,h.name,h.role);const d=i(a({},h),{id:`admin-${Date.now()}`});S(f=>[...f,d]),x.success("User added successfully!"),C({name:"",email:"",password:"",role:"user"})}catch(d){console.error("Failed to add user:",d),x.error("Failed to add user")}}),G=s=>{L(s),b({name:s.name,email:s.email,password:s.password,role:s.role}),c("editUser")},H=s=>P(void 0,null,function*(){if(s.preventDefault(),N.find(d=>d.email===u.email&&d.id!==w.id)){x.error("Email already exists for another user");return}try{const d=yield se(w.id,{name:u.name,email:u.email,role:u.role});S(f=>f.map(y=>y.id===w.id?a(a({},y),d):y)),x.success("User updated successfully!"),L(null),b({name:"",email:"",password:"",role:"user"}),c("users")}catch(d){console.error("Failed to update user:",d),x.error("Failed to update user")}}),J=s=>P(void 0,null,function*(){if(window.confirm("Are you sure you want to delete this user?"))try{yield ae(s),S(p=>p.filter(d=>d.id!==s)),x.success("User deleted successfully!")}catch(p){console.error("Failed to delete user:",p),x.error("Failed to delete user")}}),K=()=>{L(null),b({name:"",email:"",password:"",role:"user"}),c("users")};return m?e.jsx("div",{className:"modal active admin-modal",children:e.jsxs("div",{className:"modal-content admin-panel",children:[e.jsx("button",{className:"modal-close",onClick:o,"aria-label":"Close admin",children:"âœ•"}),e.jsxs("div",{className:"admin-layout",children:[e.jsxs("aside",{className:"admin-sidebar",children:[e.jsx("div",{className:"brand",children:"Admin"}),e.jsxs("nav",{children:[e.jsxs("button",{className:`sidebar-link ${t==="products"?"active":""}`,onClick:()=>c("products"),children:["Products ",e.jsx("span",{className:"count",children:n.length})]}),e.jsxs("button",{className:`sidebar-link ${t==="orders"?"active":""}`,onClick:()=>c("orders"),children:["Orders ",e.jsx("span",{className:"count",children:k.length})]}),e.jsxs("button",{className:`sidebar-link ${t==="users"?"active":""}`,onClick:()=>c("users"),children:["Users ",e.jsx("span",{className:"count",children:N.length})]}),e.jsx("button",{className:`sidebar-link ${t==="add"?"active":""}`,onClick:()=>c("add"),children:"Add Product"}),e.jsx("button",{className:`sidebar-link ${t==="addUser"?"active":""}`,onClick:()=>c("addUser"),children:"Add User"})]}),e.jsx("div",{className:"sidebar-footer",children:"Luxe Dashboard"})]}),e.jsxs("main",{className:"admin-main",children:[e.jsxs("header",{className:"admin-main-header",children:[e.jsx("h2",{children:"Admin Panel"}),e.jsxs("div",{className:"admin-actions",children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>x.success("Saved"),children:"Save"}),e.jsx("button",{className:"btn btn-secondary",onClick:o,children:"Close"})]})]}),e.jsxs("section",{className:"admin-content-area",children:[t==="products"&&e.jsxs("div",{children:[e.jsxs("div",{className:"dashboard-cards",children:[e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-value",children:n.length}),e.jsx("div",{className:"stat-label",children:"Products"})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-value",children:k.length}),e.jsx("div",{className:"stat-label",children:"Orders"})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-value",children:n.filter(s=>s.inStock).length}),e.jsx("div",{className:"stat-label",children:"In Stock"})]})]}),e.jsx("div",{className:"card table-card",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Stock"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:n.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.id}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.category}),e.jsx("td",{children:T(s.price)}),e.jsx("td",{children:s.inStock?"In Stock":"Out"}),e.jsxs("td",{className:"actions-cell",children:[e.jsx("button",{className:"btn-sm btn-edit",onClick:()=>B(s),children:"Edit"}),e.jsx("button",{className:"btn-sm btn-danger",onClick:()=>{D(s.id)},children:"Delete"})]})]},s.id))})]})})]}),t==="orders"&&e.jsx("div",{children:e.jsx("div",{className:"card table-card",children:k.length===0?e.jsx("p",{className:"muted",children:"No orders yet"}):e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:k.map(s=>e.jsxs("tr",{children:[e.jsxs("td",{children:["#",s.id]}),e.jsx("td",{children:s.customerName}),e.jsx("td",{children:s.items.length}),e.jsx("td",{children:T(s.total)}),e.jsx("td",{children:new Date(s.date).toLocaleDateString()}),e.jsx("td",{children:e.jsx("span",{className:"status-badge",children:s.status})})]},s.id))})]})})}),t==="users"&&e.jsxs("div",{children:[e.jsxs("div",{className:"dashboard-cards",children:[e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-value",children:N.length}),e.jsx("div",{className:"stat-label",children:"Total Users"})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-value",children:N.filter(s=>s.role==="admin").length}),e.jsx("div",{className:"stat-label",children:"Admins"})]}),e.jsxs("div",{className:"card stat-card",children:[e.jsx("div",{className:"stat-value",children:N.filter(s=>s.role==="user").length}),e.jsx("div",{className:"stat-label",children:"Regular Users"})]})]}),e.jsx("div",{className:"card table-card",children:$?e.jsx("p",{children:"Loading users..."}):e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:N.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.id}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.email}),e.jsx("td",{children:e.jsx("span",{className:`role-badge ${s.role}`,children:s.role})}),e.jsxs("td",{className:"actions-cell",children:[e.jsx("button",{className:"btn-sm btn-edit",onClick:()=>G(s),children:"Edit"}),e.jsx("button",{className:"btn-sm btn-danger",onClick:()=>J(s.id),children:"Delete"})]})]},s.id))})]})})]}),t==="add"&&e.jsx("div",{className:"card form-card",children:e.jsxs("form",{onSubmit:O,className:"admin-add-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Product Name"}),e.jsx("input",{type:"text",value:r.name,onChange:s=>v(i(a({},r),{name:s.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{value:r.category,onChange:s=>v(i(a({},r),{category:s.target.value})),children:[e.jsx("option",{value:"living-room",children:"Living Room"}),e.jsx("option",{value:"dining",children:"Dining"}),e.jsx("option",{value:"bedroom",children:"Bedroom"}),e.jsx("option",{value:"office",children:"Office"}),e.jsx("option",{value:"entryway",children:"Entryway"}),e.jsx("option",{value:"decor",children:"Decor"}),e.jsx("option",{value:"lighting",children:"Lighting"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Price"}),e.jsx("input",{type:"number",value:r.price,onChange:s=>v(i(a({},r),{price:s.target.value})),min:"0",step:"0.01",required:!0})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:r.description,onChange:s=>v(i(a({},r),{description:s.target.value})),rows:4})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Image URL"}),e.jsx("input",{type:"url",value:r.images[0],onChange:s=>v(i(a({},r),{images:[s.target.value]}))})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:r.inStock,onChange:s=>v(i(a({},r),{inStock:s.target.checked}))})," In Stock"]})})]}),e.jsx("div",{style:{marginTop:"1rem"},children:e.jsx("button",{className:"btn btn-primary",type:"submit",children:"Add Product"})})]})}),t==="edit"&&q&&e.jsxs("div",{className:"card form-card",children:[e.jsx("h3",{children:"Edit Product"}),e.jsxs("form",{onSubmit:_,className:"admin-add-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Product Name"}),e.jsx("input",{type:"text",value:l.name,onChange:s=>g(i(a({},l),{name:s.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{value:l.category,onChange:s=>g(i(a({},l),{category:s.target.value})),children:[e.jsx("option",{value:"living-room",children:"Living Room"}),e.jsx("option",{value:"dining",children:"Dining"}),e.jsx("option",{value:"bedroom",children:"Bedroom"}),e.jsx("option",{value:"office",children:"Office"}),e.jsx("option",{value:"entryway",children:"Entryway"}),e.jsx("option",{value:"decor",children:"Decor"}),e.jsx("option",{value:"lighting",children:"Lighting"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Price"}),e.jsx("input",{type:"number",value:l.price,onChange:s=>g(i(a({},l),{price:s.target.value})),min:"0",step:"0.01",required:!0})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:l.description,onChange:s=>g(i(a({},l),{description:s.target.value})),rows:4})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Image URL"}),e.jsx("input",{type:"url",value:l.images[0],onChange:s=>g(i(a({},l),{images:[s.target.value]}))})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:l.inStock,onChange:s=>g(i(a({},l),{inStock:s.target.checked}))})," In Stock"]})})]}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn btn-primary",type:"submit",children:"Update Product"}),e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:Q,children:"Cancel"})]})]})]}),t==="addUser"&&e.jsx("div",{className:"card form-card",children:e.jsxs("form",{onSubmit:z,className:"admin-add-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Name"}),e.jsx("input",{type:"text",value:h.name,onChange:s=>C(i(a({},h),{name:s.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",value:h.email,onChange:s=>C(i(a({},h),{email:s.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password"}),e.jsx("input",{type:"password",value:h.password,onChange:s=>C(i(a({},h),{password:s.target.value})),required:!0})]})]}),e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Role"}),e.jsxs("select",{value:h.role,onChange:s=>C(i(a({},h),{role:s.target.value})),children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]})}),e.jsx("div",{style:{marginTop:"1rem"},children:e.jsx("button",{className:"btn btn-primary",type:"submit",children:"Add User"})})]})}),t==="editUser"&&w&&e.jsxs("div",{className:"card form-card",children:[e.jsx("h3",{children:"Edit User"}),e.jsxs("form",{onSubmit:H,className:"admin-add-form",children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Name"}),e.jsx("input",{type:"text",value:u.name,onChange:s=>b(i(a({},u),{name:s.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email"}),e.jsx("input",{type:"email",value:u.email,onChange:s=>b(i(a({},u),{email:s.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password"}),e.jsx("input",{type:"password",value:u.password,onChange:s=>b(i(a({},u),{password:s.target.value})),required:!0})]})]}),e.jsx("div",{className:"form-row",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Role"}),e.jsxs("select",{value:u.role,onChange:s=>b(i(a({},u),{role:s.target.value})),children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]})}),e.jsxs("div",{style:{marginTop:"1rem",display:"flex",gap:"1rem"},children:[e.jsx("button",{className:"btn btn-primary",type:"submit",children:"Update User"}),e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:K,children:"Cancel"})]})]})]})]})]})]})]})}):null};export{ce as default};
