var C=Object.defineProperty,q=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var O=(d,n,i)=>n in d?C(d,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[n]=i,m=(d,n)=>{for(var i in n||(n={}))T.call(n,i)&&O(d,i,n[i]);if(w)for(var i of w(n))A.call(n,i)&&O(d,i,n[i]);return d},g=(d,n)=>q(d,z(n));import{j as r}from"./index-02495058.js";import{r as o}from"./vendor-9fe24c3f.js";import{u as F}from"./router-4197aa40.js";import"./ui-9e04399f.js";import"./supabase-f3f4aacd.js";const I="orders",D="returns",Y=()=>{const d=F(),[n,i]=o.useState([]),[x,b]=o.useState([]),[p,y]=o.useState(""),[j,S]=o.useState(""),[f,c]=o.useState([]),[l,h]=o.useState("");o.useEffect(()=>{try{const e=localStorage.getItem(I);if(e){const s=JSON.parse(e),a=new Date;a.setDate(a.getDate()-30),i(s.filter(u=>u.status==="Delivered"&&new Date(u.date)>a))}const t=localStorage.getItem(D);t&&b(JSON.parse(t))}catch(e){console.error("Error loading data:",e)}},[]);const k=e=>{const t=e.target.value;if(y(t),t){const s=n.find(a=>String(a.id)===String(t));s&&c(s.items.map(a=>g(m({},a),{selected:!1,reason:""})))}else c([])},E=e=>{c(t=>t.map(s=>s.id===e?g(m({},s),{selected:!s.selected}):s))},N=(e,t)=>{c(s=>s.map(a=>a.id===e?g(m({},a),{reason:t}):a))},B=e=>{e.preventDefault();const t=f.filter(s=>s.selected);if(t.length===0){h("Please select at least one item to return");return}if(t.some(s=>!s.reason)){h("Please provide a reason for each selected item");return}try{const s={id:Date.now(),orderId:p,date:new Date().toISOString(),status:"Pending",items:t,reason:j},a=[...x,s];localStorage.setItem(D,JSON.stringify(a)),b(a),y(""),S(""),c([]),h("Return request submitted successfully");const u=n.map(v=>String(v.id)===String(p)?g(m({},v),{hasReturn:!0}):v);localStorage.setItem(I,JSON.stringify(u)),i(u)}catch(s){console.error("Error submitting return:",s),h("Error submitting return request")}},R=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return r.jsx("div",{className:"section",children:r.jsxs("div",{className:"container",style:{maxWidth:"800px",margin:"0 auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[r.jsx("h2",{className:"section-title",children:"Returns & Refunds"}),r.jsx("button",{className:"btn btn-secondary",onClick:()=>d("/orders"),children:"View Orders"})]}),l&&r.jsx("div",{style:{padding:"1rem",marginBottom:"1rem",borderRadius:"4px",background:l.includes("Error")?"var(--error-bg)":l.includes("success")?"var(--success-bg)":"var(--warning-bg)",color:l.includes("Error")?"var(--error-text)":l.includes("success")?"var(--success-text)":"var(--warning-text)"},children:l}),r.jsxs("form",{onSubmit:B,children:[r.jsxs("div",{style:{marginBottom:"1.5rem"},children:[r.jsx("label",{htmlFor:"order",style:{display:"block",marginBottom:"0.5rem"},children:"Select Order *"}),r.jsxs("select",{id:"order",value:p,onChange:k,style:{width:"100%",padding:"0.75rem",borderRadius:"4px",border:"1px solid var(--border-color)",background:"var(--input-bg)",color:"var(--text-primary)"},required:!0,children:[r.jsx("option",{value:"",children:"Select an order..."}),n.map(e=>r.jsxs("option",{value:e.id,disabled:e.hasReturn,children:["Order #",e.id," - ",R(e.date),e.hasReturn?" (Return Requested)":""]},e.id))]})]}),p&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{marginBottom:"1.5rem"},children:[r.jsx("h4",{style:{marginBottom:"1rem"},children:"Select Items to Return"}),r.jsx("div",{style:{display:"grid",gap:"1rem"},children:f.map(e=>r.jsxs("div",{style:{padding:"1rem",borderRadius:"4px",border:"1px solid var(--border-color)",background:"var(--bg-secondary)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"0.5rem"},children:[r.jsx("input",{type:"checkbox",id:`item-${e.id}`,checked:e.selected,onChange:()=>E(e.id),style:{marginRight:"0.5rem"}}),r.jsxs("label",{htmlFor:`item-${e.id}`,children:[e.name," (Qty: ",e.quantity,")"]})]}),e.selected&&r.jsxs("select",{value:e.reason,onChange:t=>N(e.id,t.target.value),style:{width:"100%",padding:"0.5rem",marginTop:"0.5rem",borderRadius:"4px",border:"1px solid var(--border-color)",background:"var(--input-bg)",color:"var(--text-primary)"},required:!0,children:[r.jsx("option",{value:"",children:"Select reason for return..."}),r.jsx("option",{value:"wrong-size",children:"Wrong Size"}),r.jsx("option",{value:"defective",children:"Defective Item"}),r.jsx("option",{value:"not-as-described",children:"Not as Described"}),r.jsx("option",{value:"changed-mind",children:"Changed Mind"}),r.jsx("option",{value:"other",children:"Other"})]})]},e.id))})]}),r.jsxs("div",{style:{marginBottom:"1.5rem"},children:[r.jsx("label",{htmlFor:"reason",style:{display:"block",marginBottom:"0.5rem"},children:"Additional Comments"}),r.jsx("textarea",{id:"reason",value:j,onChange:e=>S(e.target.value),style:{width:"100%",padding:"0.75rem",borderRadius:"4px",border:"1px solid var(--border-color)",background:"var(--input-bg)",color:"var(--text-primary)",minHeight:"100px"}})]}),r.jsx("button",{type:"submit",className:"btn btn-primary",children:"Submit Return Request"})]})]}),x.length>0&&r.jsxs("div",{style:{marginTop:"3rem"},children:[r.jsx("h3",{style:{marginBottom:"1rem"},children:"Previous Returns"}),r.jsx("div",{style:{display:"grid",gap:"1rem"},children:x.map(e=>r.jsxs("div",{style:{padding:"1rem",borderRadius:"4px",background:"var(--bg-secondary)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[r.jsxs("div",{children:[r.jsxs("strong",{children:["Return #",e.id]}),r.jsx("span",{style:{margin:"0 0.5rem"},children:"•"}),r.jsxs("span",{children:["Order #",e.orderId]})]}),r.jsx("div",{style:{padding:"0.25rem 0.5rem",borderRadius:"4px",background:e.status==="Approved"?"var(--success-bg)":e.status==="Rejected"?"var(--error-bg)":"var(--warning-bg)",color:e.status==="Approved"?"var(--success-text)":e.status==="Rejected"?"var(--error-text)":"var(--warning-text)",fontSize:"0.875rem"},children:e.status})]}),r.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:["Submitted on ",R(e.date)]}),r.jsx("div",{style:{marginTop:"0.5rem"},children:e.items.map(t=>r.jsxs("div",{style:{fontSize:"0.875rem"},children:["• ",t.name," - ",t.reason.replace("-"," ")]},t.id))})]},e.id))})]})]})})};export{Y as default};
